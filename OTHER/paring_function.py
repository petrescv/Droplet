# -*- coding: utf-8 -*-
"""
Created on Sun Jan 15 16:42:09 2017

@author: Vlad Petrescu
contact: petrescv@gmail.com
web:     vladpetrescu.wordpress.com
"""

import numpy as np
import matplotlib.pyplot as plt



centres = [[(561.7857055664062, 1022.2142944335938), (1041.0487060546875, 1024.6680908203125), (853.0, 1025.5), (424.5, 1012.5), (1338.5, 1002.0), (469.2167053222656, 1007.3405151367188), (367.0, 994.5), (460.49688720703125, 958.14794921875), (408.5, 953.5), (1152.0, 941.0), (1315.0, 941.0), (674.5, 928.5), (1265.5625, 920.5625), (947.0882568359375, 918.0882568359375), (1335.5, 912.5), (1235.27783203125, 913.9444580078125), (828.9545288085938, 909.227294921875), (541.0, 909.7777709960938), (1117.0, 904.0), (900.5, 882.5), (1180.193603515625, 864.6129150390625), (690.3386840820312, 840.7903442382812), (561.625, 827.0625), (1209.5, 844.0), (1311.5, 816.0), (1175.0, 817.0), (360.0, 818.0), (1041.5, 793.0), (635.0, 798.0), (1043.5, 792.0), (1349.878662109375, 802.4805908203125), (738.0, 789.0), (713.6136474609375, 784.852294921875), (1288.57373046875, 781.2894897460938), (1059.810302734375, 770.6724243164062), (640.0, 763.5), (368.5, 774.0), (997.96044921875, 761.1115112304688), (1309.0, 751.0), (989.388916015625, 734.611083984375), (1187.0, 723.0), (770.4729614257812, 721.3648681640625), (818.5, 692.0), (429.5, 680.0), (557.0, 670.0), (725.0, 665.5), (1286.75, 647.75), (837.4122924804688, 645.131591796875), (781.5, 656.0), (1058.0, 634.5), (865.5, 635.5), (1336.0, 631.5), (1055.0, 608.0), (778.1956787109375, 615.7608642578125), (755.0, 607.0), (893.5, 607.5), (435.1875, 609.75), (504.1623229980469, 602.4220581054688), (913.5, 601.3571166992188), (852.0, 604.0), (788.45654296875, 581.8043212890625), (1314.6348876953125, 589.3314819335938), (945.524658203125, 586.4898681640625), (912.5, 566.5), (1193.5, 566.0), (1337.3809814453125, 549.2880859375), (876.0, 545.5), (898.0, 539.5), (1244.0, 552.5), (1092.375, 533.625), (1356.27783203125, 519.2036743164062), (1296.0, 519.0), (1085.772705078125, 514.772705078125), (932.0, 508.0), (820.5, 503.0), (745.4189453125, 507.52703857421875), (1331.2353515625, 490.0), (1306.75, 482.0), (1087.5, 466.5), (616.3674926757812, 467.6204833984375), (1264.0614013671875, 453.3596496582031), (913.5, 450.5), (972.0, 429.5), (858.0, 449.5), (1300.5, 422.5), (1035.0999755859375, 417.1000061035156), (1350.46875, 419.40625), (1071.8260498046875, 412.2173767089844), (781.0, 417.0), (1105.5, 408.5), (1181.404052734375, 400.5548095703125), (1246.0999755859375, 398.0), (495.0, 391.5), (863.3064575195312, 381.4032287597656), (781.5, 386.82000732421875), (518.9000244140625, 372.8999938964844), (1039.8680419921875, 378.7708435058594), (1239.5, 365.0), (563.5, 367.0), (1135.0, 366.0), (1353.4912109375, 358.9040222167969), (1093.607177734375, 332.78570556640625), (510.5, 325.5), (713.0, 337.0), (1161.0, 306.0), (1359.269287109375, 306.73077392578125), (1254.5999755859375, 303.0), (799.4425659179688, 309.8014221191406), (1174.0, 306.5), (588.9285888671875, 302.71429443359375), (1179.300048828125, 280.5), (1177.0, 277.0), (1027.0, 259.0), (912.7999877929688, 256.0), (1299.3790283203125, 252.4426727294922), (860.98388671875, 235.69354248046875), (1245.8125, 238.8125), (823.0938110351562, 229.23898315429688), (1113.5, 214.5), (969.9166870117188, 194.125), (1253.0, 184.0), (1338.125, 170.0), (969.0, 138.0), (1052.0, 103.69999694824219), (1138.8636474609375, 100.7727279663086), (832.6649780273438, 93.60309600830078), (949.6935424804688, 82.7258071899414), (1104.451171875, 66.54878234863281), (1352.5, 56.5), (1073.0, 52.0), (819.0, 57.0), (878.5, 47.0), (1034.8060302734375, 13.641791343688965), (981.5, 26.0), (805.0, 10.0)], [(1184.0, 1030.5), (847.5, 1028.0), (422.0, 1017.0), (424.6666564941406, 1015.3333129882812), (1336.0, 1011.0), (1332.0, 1010.5), (1333.0, 1006.5), (1093.0, 1004.5), (1337.8043212890625, 1004.45654296875), (467.0, 1012.5), (363.0, 999.0), (905.5, 975.5), (756.0, 960.0), (456.5, 964.5), (404.6675109863281, 960.7741088867188), (948.5, 943.5), (1148.857177734375, 947.4285888671875), (1298.0, 933.0), (1312.0, 948.0), (673.0, 932.5), (1114.5, 924.0), (1261.3125, 926.3125), (1231.5, 921.5), (944.8592529296875, 923.8689575195312), (1234.5, 919.0), (1123.772705078125, 919.0818481445312), (728.5, 914.0), (1120.0, 909.5), (537.4920043945312, 916.2319946289062), (825.772705078125, 912.5), (1106.323486328125, 895.38232421875), (899.0999755859375, 887.9000244140625), (1065.0, 886.0), (773.0, 880.5), (1182.5, 873.5), (1370.5, 867.5), (1177.90283203125, 869.0755615234375), (987.5, 853.0), (689.0, 850.5), (1293.0, 851.0), (691.5, 843.0), (686.4615478515625, 847.3846435546875), (563.5, 831.5), (559.0, 833.5), (1208.5, 851.0), (354.5, 826.5), (1357.0, 819.5), (358.0, 822.5), (1172.0, 823.5), (1370.5, 807.0), (1366.0, 806.5), (1368.5, 803.0), (632.5, 804.5), (1039.5, 796.0), (1346.4102783203125, 807.9385375976562), (733.9444580078125, 795.9444580078125), (717.0, 789.5), (711.0, 789.0), (1290.5, 784.0), (1287.5, 786.5), (1042.5, 774.0), (1056.5, 777.5), (1303.0, 772.5), (1061.5, 772.0), (1058.5, 772.0), (365.0, 779.5), (992.5901489257812, 767.0737915039062), (1158.5, 747.5), (1321.5, 746.5), (1307.0, 756.0), (986.5, 739.5), (1191.0, 728.5), (1187.5, 728.5), (1183.0714111328125, 730.0357055664062), (767.51611328125, 727.6370849609375), (815.5641479492188, 698.1845092773438), (427.0, 684.0), (554.0, 675.5), (722.5, 670.5), (1285.0, 655.8333129882812), (1287.0, 654.0), (1008.5, 651.0), (1176.0, 647.1666870117188), (778.5, 662.0), (835.0, 650.0), (1342.5, 639.0), (1058.9090576171875, 639.9545288085938), (1054.0, 640.5), (1056.0999755859375, 636.9000244140625), (1281.5, 635.0), (862.0, 640.5), (1337.0, 638.0), (775.0247802734375, 621.7079467773438), (432.0, 615.0), (892.3571166992188, 609.6428833007812), (501.55999755859375, 607.739990234375), (910.1216430664062, 605.7161865234375), (1202.0, 596.5), (848.5, 612.0), (787.5, 586.0), (1312.2725830078125, 595.7550659179688), (1196.5, 583.0), (1183.0, 580.5), (1167.5, 576.5), (1200.5, 572.0), (909.5, 571.0), (1190.0, 571.0), (1350.5, 561.0), (1322.5, 559.5), (1334.5, 555.0), (1251.5, 549.5), (873.0, 552.0), (894.5980224609375, 544.9215698242188), (1248.0999755859375, 539.0999755859375), (1242.0, 558.0), (1091.0172119140625, 536.6724243164062), (1352.0, 526.5), (1082.5, 521.5), (1294.1600341796875, 524.260009765625), (1082.5, 518.0), (929.2777709960938, 514.0555419921875), (817.6428833007812, 508.0), (742.0, 513.5), (1328.0, 495.0), (1303.0, 488.0), (609.5, 468.0), (613.8648681640625, 473.2837829589844), (1259.65380859375, 458.5769348144531), (910.5, 456.0), (970.0, 434.0), (851.0, 456.5), (1298.0, 429.0), (1299.5, 428.0), (1296.5, 424.5), (1031.0, 424.5), (1111.5, 411.0), (1068.5294189453125, 418.5882263183594), (1104.0, 413.5), (1178.2454833984375, 405.4272766113281), (1245.5, 401.0), (493.0, 395.1666564941406), (781.5, 409.5), (860.1087036132812, 387.5260925292969), (519.5, 372.5), (1240.9000244140625, 370.8999938964844), (1235.5, 371.5), (1036.0, 386.0), (560.9761962890625, 373.0238037109375), (1232.5, 365.0), (1132.0, 373.0), (1349.2279052734375, 365.1572570800781), (1089.40478515625, 340.4047546386719), (711.615966796875, 342.7190856933594), (1152.0, 315.0), (1069.5, 312.0), (1356.0, 313.0), (1065.5, 310.0), (1250.0, 307.3999938964844), (795.7831420898438, 317.36346435546875), (1173.0, 311.0), (585.8067626953125, 308.24847412109375), (1173.5, 284.5), (910.126220703125, 262.2281494140625), (1295.4837646484375, 259.1864929199219), (1298.5, 252.0), (858.1666870117188, 240.5), (1243.5, 243.5), (820.5, 236.5), (1110.5714111328125, 221.42857360839844), (965.0, 199.0), (1250.0384521484375, 191.0), (1299.5, 169.5), (971.5, 153.0), (965.0999755859375, 144.6999969482422), (1293.5, 132.5), (1248.5, 118.0), (1242.5, 110.5), (1136.5, 104.5), (1287.0, 101.16666412353516), (829.5, 99.78571319580078), (1149.0, 89.0), (1151.0, 87.5), (945.5, 88.5), (1148.0, 84.0), (1297.5, 58.5), (1349.0, 66.0), (1069.5, 59.5), (1066.0, 50.5), (815.1738891601562, 64.17391204833984), (875.6224365234375, 54.78571319580078), (1166.5, 39.0), (1032.5, 20.0), (979.0714111328125, 31.571428298950195), (803.0, 17.0)], [3.408179521560669, 7.551947116851807, 14.75634479522705, 4.885718822479248, 7.373678207397461, 21.628787994384766, 17.698326110839844, 18.259613037109375, 15.014701843261719, 13.429555892944336, 19.43400001525879, 3.0029401779174805, 7.802398204803467, 7.3014702796936035, 3.9221231937408447, 5.260116100311279, 10.284008026123047, 14.228433609008789, 18.425199508666992, 2.62599515914917, 7.9370293617248535, 7.894052028656006, 8.88398265838623, 28.604530334472656, 3.132622718811035, 7.498513221740723, 8.800323486328125, 3.132622718811035, 9.49613094329834, 3.4547250270843506, 15.738752365112305, 5.546719551086426, 7.843532085418701, 8.690677642822266, 7.412982940673828, 4.152062892913818, 16.48804473876953, 10.23307991027832, 21.82530975341797, 5.793282508850098, 8.239999771118164, 7.879251480102539, 10.415230751037598, 12.541069030761719, 4.246798515319824, 12.541069030761719, 4.953111171722412, 9.15451717376709, 23.538372039794922, 7.228369235992432, 9.906222343444824, 18.74628448486328, 3.257145881652832, 10.578798294067383, 2.303149938583374, 3.6415998935699463, 7.059269905090332, 6.880206108093262, 6.72766637802124, 19.99898338317871, 3.6553566455841064, 16.85964012145996, 21.14692497253418, 6.222768783569336, 11.247770309448242, 14.302874565124512, 10.912654876708984, 8.061025619506836, 23.38009262084961, 4.80704927444458, 3.382582426071167, 7.8442463874816895, 4.921457767486572, 4.606299877166748, 6.3701982498168945, 16.375967025756836, 9.027702331542969, 4.497044086456299, 2.62599515914917, 9.046821594238281, 7.282670497894287, 18.20800018310547, 3.7492566108703613, 28.325000762939453, 4.885718822479248, 2.1654560565948486, 5.787487983703613, 9.531933784484863, 17.540267944335938, 14.141416549682617, 5.791973114013672, 4.223005294799805, 4.152062892913818, 8.301972389221191, 14.830659866333008, 3.1946866512298584, 23.751197814941406, 8.061025619506836, 9.83906078338623, 23.712379455566406, 20.209686279296875, 9.318095207214355, 2.62599515914917, 22.80002212524414, 3.257146120071411, 5.9092535972595215, 5.1664557456970215, 13.847352981567383, 11.434855461120605, 8.499027252197266, 4.69073486328125, 2.303149938583374, 9.49613094329834, 10.332905769348145, 9.02341365814209, 7.200307369232178, 17.752798080444336, 18.74269676208496, 6.222768783569336, 5.1437578201293945, 9.717000007629395, 4.122011184692383, 13.818900108337402, 4.332127571105957, 3.9864275455474854, 7.014067649841309, 7.018157005310059, 19.35302734375, 13.990570068359375, 10.300000190734863, 17.72079086303711, 15.79799747467041, 10.18494987487793, 27.661781311035156, 16.122051239013672], [2.123399257659912, 11.755093574523926, 2.303149938583374, 2.768028736114502, 2.303149938583374, 2.123399257659912, 2.773359775543213, 2.123399257659912, 3.6553566455841064, 22.000810623168945, 17.630760192871094, 2.62599515914917, 2.303149938583374, 17.914302825927734, 15.036439895629883, 2.62599515914917, 13.324389457702637, 2.303149938583374, 19.785654067993164, 2.773359775543213, 2.773359775543213, 6.9244279861450195, 5.302249908447266, 7.398146152496338, 3.132622718811035, 5.3847856521606445, 2.123399257659912, 2.123399257659912, 13.638372421264648, 10.844244956970215, 2.7846994400024414, 2.1654245853424072, 2.303149938583374, 2.123399257659912, 2.625994920730591, 2.62599515914917, 8.394245147705078, 2.123399257659912, 2.123399257659912, 5.546719551086426, 2.123399257659912, 6.746248722076416, 2.62599515914917, 8.38359260559082, 28.8813533782959, 2.62599515914917, 2.123399257659912, 4.74806547164917, 6.695000171661377, 2.575000047683716, 2.123399257659912, 2.575000047683716, 9.125823020935059, 2.575000047683716, 15.585685729980469, 4.17763090133667, 2.123399257659912, 7.427435398101807, 2.123399257659912, 8.142865180969238, 3.6050000190734863, 6.714777946472168, 2.123399257659912, 2.123399257659912, 2.575000047683716, 15.663113594055176, 8.326712608337402, 2.62599515914917, 2.62599515914917, 21.727872848510742, 4.6635236740112305, 2.575000047683716, 3.6415998935699463, 5.18729829788208, 7.7362494468688965, 10.119904518127441, 12.055840492248535, 3.132622718811035, 11.766368865966797, 3.0947659015655518, 2.303149938583374, 2.123399257659912, 2.231658697128296, 23.538372039794922, 9.49613094329834, 2.123399257659912, 3.1839540004730225, 4.858500003814697, 2.1654245853424072, 2.123399257659912, 9.284294128417969, 17.988176345825195, 10.049510955810547, 6.909450054168701, 2.8014795780181885, 6.473537445068359, 6.1974005699157715, 3.4547250270843506, 20.19036293029785, 2.123399257659912, 16.77887535095215, 2.123399257659912, 2.123399257659912, 2.62599515914917, 2.123399257659912, 5.664999961853027, 10.75351619720459, 2.123399257659912, 2.62599515914917, 14.970475196838379, 2.62599515914917, 10.50398063659668, 7.316756248474121, 2.1654245853424072, 22.683395385742188, 6.201008319854736, 3.7492566108703613, 2.62599515914917, 7.589475631713867, 2.123399257659912, 3.513460397720337, 5.693580627441406, 16.71173095703125, 8.800323486328125, 2.303149938583374, 2.575000047683716, 8.578672409057617, 4.762098789215088, 18.200714111328125, 3.0899999141693115, 28.343719482421875, 2.303149938583374, 2.773359775543213, 2.62599515914917, 5.474524974822998, 2.123399257659912, 9.890934944152832, 13.596389770507812, 5.113100528717041, 2.123399257659912, 3.094764232635498, 29.467723846435547, 7.752683639526367, 2.62599515914917, 2.1654560565948486, 7.173120021820068, 23.957189559936523, 9.245513916015625, 3.6050000190734863, 24.912376403808594, 20.453514099121094, 9.004279136657715, 22.379653930664062, 2.303149938583374, 2.575000047683716, 5.149999618530273, 2.123399257659912, 2.6779942512512207, 15.04761028289795, 8.304125785827637, 8.536460876464844, 3.6415998935699463, 9.575530052185059, 8.81161880493164, 2.123399257659912, 7.3034210205078125, 17.61570930480957, 19.228199005126953, 5.202296257019043, 3.257146120071411, 8.837432861328125, 2.62599515914917, 3.7492566108703613, 12.483861923217773, 2.62599515914917, 2.575000047683716, 2.62599515914917, 2.62599515914917, 2.2316677570343018, 5.956106662750244, 2.303149938583374, 2.123399257659912, 6.714778423309326, 4.246798515319824, 2.62599515914917, 14.456738471984863, 8.770133972167969, 2.123399257659912, 17.287805557250977, 16.2519588470459, 2.123399257659912, 9.675971031188965, 27.104339599609375, 14.566399574279785]]

def find_pairs(centres):
    
    threshold = 8.
    pairs = [[],[],[],[]]
    
    for i in range(len(centres[0])):
        x0 = centres[0][i][0]
        y0 = centres[0][i][1]
        r0 = centres[2][i]
        for j in range(len(centres[1])):
            x1 = centres[1][j][0]
            y1 = centres[1][j][1]
            r1 = centres[3][j]
            
            if abs(x1 - x0) <= threshold and abs(y1 - y0) <= threshold:
                pairs[0].append((x0,y0))
                pairs[1].append((x1,y1))
                pairs[2].append(r0)
                pairs[3].append(r1)
                
    i = 0
    stop = len(pairs[0])
    while (i <= stop-1):
        
        multiple_pairs = [[],[],[],[]]
        multiple_pairs[0].append(pairs[1][i][0])
        multiple_pairs[1].append(pairs[1][i][1])
        multiple_pairs[2].append(pairs[2][i])
        multiple_pairs[3].append(pairs[3][i])
        
        j = i+1
        while (j <= stop-1):
            if pairs[0][i] == pairs[0][j]:
                multiple_pairs[0].append(pairs[1][j][0])
                multiple_pairs[1].append(pairs[1][j][1])
                multiple_pairs[2].append(pairs[2][j])
                multiple_pairs[3].append(pairs[3][j])
                del pairs[0][j]
                del pairs[1][j]
                del pairs[2][j]
                del pairs[3][j]
                stop = stop - 1
                j = j-1
            j = j+1
         
        if len(multiple_pairs[0]) > 1:
            all_x = np.array(multiple_pairs[0]) - pairs[0][i][0]*np.ones(len(multiple_pairs[0]))
            all_y = np.array(multiple_pairs[1]) - pairs[0][i][1]*np.ones(len(multiple_pairs[0]))
            dist = np.sqrt(all_x**2 + all_y**2)
            index_min = np.argmin(dist) 
            pairs[1][i] = (multiple_pairs[0][index_min], multiple_pairs[1][index_min])
            pairs[2][i] = multiple_pairs[2][index_min]
            pairs[3][i] = multiple_pairs[3][index_min]
        i = i + 1
        
        return pairs
        
print find_pairs(centres)